git_repos:
  aoc_scenario_path: "/home/ros/aoc_strawberry_scenario_ws/src/aoc_strawberry_scenario"

topics:
  # ---------------------------------------------------------
  # 1. GPS (Working)
  # ---------------------------------------------------------
  - name: "/gps_base/fix"
    type: "sensor_msgs/msg/NavSatFix"
    log_fields:
      - "latitude"
      - "longitude"
      - "altitude"
    publish:
      enable: true
      topic: "mdbi_logger/gps_alt"
      type: "std_msgs/msg/Float32"
      field: "altitude"

  # ---------------------------------------------------------
  # 2. Odometry (Working)
  # ---------------------------------------------------------
  - name: "/gophar_vehicle_controller/odometry"
    type: "nav_msgs/msg/Odometry"
    role: "odometry"
    log_fields:
      - "pose.pose.position.x"
      - "pose.pose.position.y"
      - "twist.twist.linear.x"
    publish:
      enable: false

  # ---------------------------------------------------------
  # 3. System Status (Working + intervention on fault)
  # ---------------------------------------------------------
  - name: "/gophar/system_status"
    type: "dynium_gophar_interfaces/msg/SystemStatus"
    role: "system_status"
    log_fields:
      - "fault_shutdown"
      - "hv_on"
      - "ignition_switch"
      - "charger_interlock"
      - "battery_percentage"

    # Tell logger which field carries battery level so it can be attached
    battery_field: "battery_percentage"

    publish:
      enable: true
      topic: "mdbi_logger/battery_level"
      type: "std_msgs/msg/Float32"
      field: "battery_percentage"

    # Trigger an intervention when 'fault_shutdown' changes to True
    intervention_on_change:
      fault_shutdown:
        trigger_value: true          # Only on False -> True edge
        event_type: "Fault_shutdown"

  # ---------------------------------------------------------
  # 4. [MISSING] Control Mode (REQUIRED FOR MDBI)
  # ---------------------------------------------------------
  # You must add this so the logger knows when to count 'autonomous' distance.
  # Adjust 'name' and 'mode_mapping' to match your robot.
  - name: "/gophar/operation_mode"   # <--- CHECK THIS TOPIC NAME
    type: "std_msgs/msg/String"      # <--- CHECK THIS TYPE (String, Int8, etc)
    role: "control_mode"
    mode_field: "data"               # The field inside the message holding the mode
    # Map the values your robot sends to 'Autonomous' or 'Manual'
    mode_mapping:
      "AUTO": "Autonomous"
      "MANUAL": "Manual"
      "1": "Autonomous"
      "0": "Manual"

  # ---------------------------------------------------------
  # 5. Joystick command -> Intervention trigger on activity
  # ---------------------------------------------------------
  - name: "/cmd_vel/joy"
    type: "geometry_msgs/msg/Twist"   # Adjust if different
    log_fields: []                    # We don't need to log individual fields here
    # When any message arrives on this topic, treat as an intervention
    intervention_on_message:
      enable: true
      event_type: "Joy_override"