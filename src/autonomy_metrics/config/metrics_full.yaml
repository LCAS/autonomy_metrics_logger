git_repos:
  # all repos are with reference to /home/ros/aoc_strawberry_scenario_ws/src/aoc_strawberry_scenario
  scenario: "."
  autonomy_metrics_logger: "jabas/autonomy_metrics_logger"
  navfn_planner: "jabas/navfn_planner"
  perception_boundary_estimator: "jabas/perception_boundary_estimator"
  pointcloud_processing: "jabas/pointcloud_processing"
  robot_boundary_checker: "jabas/robot_boundary_checker"
  ros2_topic_monitor: "jabas/ros2_topic_monitor"
  row_nav_planner: "jabas/row_nav_planner"
  ppl_gofar_platform: "robots/ppl_gofar_platform"
  topological_navigation: "contrib/topological_navigation"
  sentor: "contrib/sentor"
  kiss-icp: "contrib/kiss-icp"

topics:
  # ---------------------------------------------------------
  # GPS
  # ---------------------------------------------------------
  - name: "/gps_base/fix"
    type: "sensor_msgs/msg/NavSatFix"
    log_all_fields: true

  # ---------------------------------------------------------
  # Odometry
  # ---------------------------------------------------------
  - name: "/gophar_vehicle_controller/odometry"
    type: "nav_msgs/msg/Odometry"
    role: "odometry"
    log_fields:
      - "pose.pose.position.x"
      - "pose.pose.position.y"
      - "twist.twist.linear.x"
    publish:
      enable: false

  # ---------------------------------------------------------
  # System Status (intervention on fault)
  # ---------------------------------------------------------
  - name: "/gophar/system_status"
    type: "dynium_gophar_interfaces/msg/SystemStatus"
    role: "system_status"
    log_all_fields: true

    # Tell logger which field carries battery level so it can be attached
    battery_field: "battery_percentage"

    publish:
      enable: true
      topic: "mdbi_logger/battery_level"
      type: "std_msgs/msg/Float32"
      field: "battery_percentage"

    # Trigger an intervention when 'fault_shutdown' changes to True
    intervention_on_change:
      fault_shutdown:
        trigger_value: true          # Only on False -> True edge
        event_type: "Fault_shutdown"

  # ---------------------------------------------------------
  # [MISSING] Control Mode (REQUIRED FOR MDBI)
  # ---------------------------------------------------------
  # You must add this so the logger knows when to count 'autonomous' distance.
  # Adjust 'name' and 'mode_mapping' to match your robot.
  # - name: "/gophar/operation_mode"   # <--- CHECK THIS TOPIC NAME
  #   type: "std_msgs/msg/String"      # <--- CHECK THIS TYPE (String, Int8, etc)
  #   role: "control_mode"
  #   mode_field: "data"               # The field inside the message holding the mode
  #   # Map the values your robot sends to 'Autonomous' or 'Manual'
  #   mode_mapping:
  #     "AUTO": "Autonomous"
  #     "MANUAL": "Manual"
  #     "1": "Autonomous"
  #     "0": "Manual"

  # ---------------------------------------------------------
  # Mode observation via velocity command
  # ---------------------------------------------------------
  # Rule: the heuristic will only be used if there is no topic with role: "control_mode" configured in the YAML.
  - name: "/cmd_vel/collision_smoothed"
    type: "geometry_msgs/msg/Twist"
    role: "mode_observer"
    log_fields: []     # keep empty if you don't want per-message events


  # ---------------------------------------------------------
  # Joystick command -> Intervention trigger on activity
  # ---------------------------------------------------------
  - name: "/cmd_vel_joy_smoothed"
    type: "geometry_msgs/msg/Twist"   # Adjust if different
    log_fields: []                    # We don't need to log individual fields here
    # When any message arrives on this topic, treat as an intervention
    intervention_on_message:
      enable: true
      event_type: "Joy_override"

  # ---------------------------------------------------------
  # Collision monitor: nav vs collision-filtered velocity
  # ---------------------------------------------------------
  - name: "/cmd_vel/nav"
    type: "geometry_msgs/msg/Twist"
    role: "collision_nav"
    log_fields: []   # no per-message events needed

  - name: "/cmd_vel/collision"
    type: "geometry_msgs/msg/Twist"
    role: "collision_output"
    log_fields: []   # no per-message events needed

  # ---------------------------------------------------------
  # Steering actuator + motor status snapshots for interventions
  # ---------------------------------------------------------
  - name: "/gophar/steering_actuator/front"
    type: "dynium_gophar_interfaces/msg/SteeringActuatorStatus"
    log_all_fields: true
    
  - name: "/gophar/steering_actuator/rear"
    type: "dynium_gophar_interfaces/msg/SteeringActuatorStatus"
    log_all_fields: true

  - name: "/gophar/motor_status/motor_0"
    type: "dynium_gophar_interfaces/msg/MotorStatus"
    log_all_fields: true

  - name: "/gophar/motor_status/motor_1"
    type: "dynium_gophar_interfaces/msg/MotorStatus"
    log_all_fields: true